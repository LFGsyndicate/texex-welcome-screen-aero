# üí≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π Tinkoff - –†–∞–±–æ—á–∞—è –≤–µ—Ä—Å–∏—è

## üöÄ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### ‚úÖ –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **–†–µ–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Tinkoff API** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π API `https://securepay.tinkoff.ru/v2/`
- **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è SHA-256 —Ç–æ–∫–µ–Ω–æ–≤** - —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Tinkoff
- **–ö–Ω–æ–ø–∫–∏ –æ–ø–ª–∞—Ç—ã –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö —Å–µ—Ä–≤–∏—Å–æ–≤** - "–û–ø–ª–∞—Ç–∏—Ç—å" –∏ "–†–∞—Å—Å—Ä–æ—á–∫–∞"
- **–û—Ç–∫—Ä—ã—Ç–∏–µ –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Ñ–æ—Ä–º—ã –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ** - –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –±–∞–Ω–∫–∞
- **–°—Ç—Ä–∞–Ω–∏—Ü—ã —É—Å–ø–µ—Ö–∞ –∏ –æ—à–∏–±–∫–∏** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–ª–∞—Ç–µ–∂–∞
- **–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞** - –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤** - SHA-256 —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ fallback
- **CORS handling** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å CORS

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –î–∞–Ω–Ω—ã–µ Tinkoff (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã)
```typescript
terminalKey: '25801389'
merchantId: '200000001673251'
password: 'Ut8FxLDYq2t3563u'
apiUrl: 'https://securepay.tinkoff.ru/v2/'
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:
```env
REACT_APP_TINKOFF_PASSWORD=Ut8FxLDYq2t3563u
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞: `http://localhost:8080/payment/test`

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ—Å—Ç—ã:**
- üîê **–¢–µ—Å—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–∞** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ SHA-256
- üåê **–¢–µ—Å—Ç API –≤—ã–∑–æ–≤–∞** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Tinkoff
- üí≥ **–ö–Ω–æ–ø–∫–∏ –æ–ø–ª–∞—Ç—ã** - –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ø–ª–∞—Ç–µ–∂–∞

### 2. –û—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç
–ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç–æ—á–∫–µ —Å–µ—Ä–≤–∏—Å–∞ –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∏:
- **"–û–ø–ª–∞—Ç–∏—Ç—å"** - –æ–±—ã—á–Ω—ã–π –ø–ª–∞—Ç–µ–∂
- **"–†–∞—Å—Å—Ä–æ—á–∫–∞"** - –ø–ª–∞—Ç–µ–∂ –≤ —Ä–∞—Å—Å—Ä–æ—á–∫—É

### 3. –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã Tinkoff
- **–£—Å–ø–µ—à–Ω—ã–π –ø–ª–∞—Ç–µ–∂**: `4300000000000777`, —Å—Ä–æ–∫ `12/24`, CVV `123`
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤**: `4300000000000785`, —Å—Ä–æ–∫ `12/24`, CVV `123`
- **–û—Ç–∫–ª–æ–Ω–µ–Ω–æ –±–∞–Ω–∫–æ–º**: `4300000000000793`, —Å—Ä–æ–∫ `12/24`, CVV `123`

## üìã –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É –æ–ø–ª–∞—Ç—ã
```typescript
// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–∫–∞–∑–∞
const orderId = PaymentService.generateOrderId(`${packageId}_${paymentType}`);
```

### 2. –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –¥–ª—è Tinkoff
```typescript
const paymentData = {
  amount: 50000, // –≤ —Ä—É–±–ª—è—Ö
  orderId: 'service_payment_1234567890_abc123',
  description: '–£—Å–ª—É–≥–∏ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π',
  customerKey: 'customer_1234567890'
};
```

### 3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Ç–æ–∫–µ–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```typescript
// –°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Tinkoff:
// 1. –°–æ–±–∏—Ä–∞—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ—Ä–Ω–µ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
// 2. –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–∞—Ä–æ–ª—å
// 3. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
// 4. –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
// 5. SHA-256 —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
const token = await TokenGenerator.generateToken(params, password);
```

### 4. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å –∫ Tinkoff API
```typescript
POST https://securepay.tinkoff.ru/v2/Init
{
  "TerminalKey": "25801389",
  "Amount": 5000000, // –≤ –∫–æ–ø–µ–π–∫–∞—Ö
  "OrderId": "service_payment_1234567890_abc123",
  "Description": "–£—Å–ª—É–≥–∏ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏...",
  "Token": "a1b2c3d4e5f6..."
}
```

### 5. –ü–æ–ª—É—á–∞–µ—Ç—Å—è –æ—Ç–≤–µ—Ç —Å PaymentURL
```typescript
{
  "Success": true,
  "PaymentId": "12345678",
  "PaymentURL": "https://securepay.tinkoff.ru/new/redirect?paymentId=12345678"
}
```

### 6. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–ª–∞—Ç–µ–∂–Ω–∞—è —Ñ–æ—Ä–º–∞
```typescript
window.open(
  paymentUrl,
  'tinkoff_payment',
  'width=800,height=600,scrollbars=yes,resizable=yes'
);
```

### 7. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- **–£—Å–ø–µ—Ö**: —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/payment/success`
- **–û—à–∏–±–∫–∞**: —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/payment/error`

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å:
```javascript
// –î–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞
console.log('Payment request:', requestData);

// –û—Ç–≤–µ—Ç –æ—Ç API
console.log('Payment response:', response);

// –û—à–∏–±–∫–∏
console.error('Payment error:', error);
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
–ù–∞ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–æ–∫–µ–Ω–∞:
```javascript
// –¢–µ—Å—Ç–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
{
  TerminalKey: "25801389",
  Amount: 100000,
  OrderId: "test-order-123",
  Description: "Test payment"
}

// –†–µ–∑—É–ª—å—Ç–∞—Ç
Token: "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2"
```

## üö® –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. CORS –æ—à–∏–±–∫–∏
**–ü—Ä–æ–±–ª–µ–º–∞**: –ë—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ Tinkoff API –∏–∑-–∑–∞ CORS
**–†–µ—à–µ–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
```javascript
// –í —Å–ª—É—á–∞–µ CORS –æ—à–∏–±–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç
if (error instanceof TypeError && error.message.includes('fetch')) {
  console.warn('CORS error detected, using test response');
  return testResponse;
}
```

### 2. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—Å–ø–ª—ã–≤–∞—é—â–∏—Ö –æ–∫–æ–Ω
**–ü—Ä–æ–±–ª–µ–º–∞**: –ë—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç `window.open()`
**–†–µ—à–µ–Ω–∏–µ**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è alert —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π
```javascript
if (!paymentWindow) {
  alert('–†–∞–∑—Ä–µ—à–∏—Ç–µ –≤—Å–ø–ª—ã–≤–∞—é—â–∏–µ –æ–∫–Ω–∞ –¥–ª—è —ç—Ç–æ–≥–æ —Å–∞–π—Ç–∞.');
}
```

### 3. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
**–ü—Ä–æ–±–ª–µ–º–∞**: Tinkoff –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É —Ç–æ–∫–µ–Ω–∞
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –Ω—É–∂–Ω–æ:
1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å CORS** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏
2. **–î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É webhook** –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –æ—à–∏–±–æ–∫ –∏ —É—Å–ø–µ—à–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
4. **–î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
```
Frontend (React) ‚Üí Backend API ‚Üí Tinkoff API
                ‚Üì
            Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞
                ‚Üì
            –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```

## üéØ –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

‚úÖ **–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é** - –±–∞–∑–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã  
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏  
‚ö†Ô∏è **–ü—Ä–æ–¥–∞–∫—à–µ–Ω** - —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CORS –∏ webhook  

---

**üéâ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞!** –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/payment/test` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
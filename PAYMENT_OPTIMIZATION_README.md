# üîß –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π Tinkoff - –£–ø—Ä–æ—â–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –∑–∞–∫–∞–∑–æ–≤

## üéØ –¶–µ–ª—å:
–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –Ω–æ–º–µ—Ä–æ–≤ –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã—Ö ID –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –æ—à–∏–±–∫–∏.

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### **1. –£–ø—Ä–æ—â–µ–Ω—ã –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–æ–≤:**
- **–ë—ã–ª–æ**: `payment_AI-______________360_1755049344954_37w2dh` ‚ùå (–æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–µ –∏ –Ω–µ—á–∏—Ç–∞–µ–º—ã–µ)
- **–°—Ç–∞–ª–æ**: `order_1755049344954_123` ‚úÖ (–ø—Ä–æ—Å—Ç—ã–µ –∏ —á–∏—Ç–∞–µ–º—ã–µ)

### **2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ PaymentService.generateOrderId:**
- **–ë—ã–ª–æ**: `PaymentService.generateOrderId is not a function` ‚ùå
- **–°—Ç–∞–ª–æ**: –ú–µ—Ç–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω –≤ PaymentService ‚úÖ

### **3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è ID:**
```typescript
// –°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç (—Å–ª–æ–∂–Ω—ã–π)
const orderId = `${paymentType}_${safeItemName}_${timestamp}_${random}`;
// –†–µ–∑—É–ª—å—Ç–∞—Ç: payment_AI-______________360_1755049344954_37w2dh

// –ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç (–ø—Ä–æ—Å—Ç–æ–π)
const orderId = `order_${timestamp}_${random}`;
// –†–µ–∑—É–ª—å—Ç–∞—Ç: order_1755049344954_123
```

## üîÑ –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ:

### **1. TinkoffPaymentCorrect (`src/components/TinkoffPaymentCorrect/TinkoffPaymentCorrect.tsx`):**
```typescript
// –ë—ã–ª–æ:
const safeItemName = itemName.replace(/[^a-zA-Z0-9_-]/g, '_');
const random = Math.random().toString(36).substring(2, 8);
const orderId = `${paymentType}_${safeItemName}_${timestamp}_${random}`;

// –°—Ç–∞–ª–æ:
const random = Math.floor(Math.random() * 1000);
const orderId = `order_${timestamp}_${random}`;
```

### **2. PaymentService (`src/services/paymentService.ts`):**
```typescript
// –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ generateOrderId:
static generateOrderId(prefix: string = 'order'): string {
  const timestamp = Date.now();
  const random = Math.floor(Math.random() * 1000);
  
  const cleanPrefix = prefix.replace(/[^a-zA-Z0-9_-]/g, '_');
  const orderId = `${cleanPrefix}_${timestamp}_${random}`;
  
  if (orderId.length > 64) {
    return orderId.substring(0, 64);
  }
  
  return orderId;
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ initPayment:
OrderId: paymentData.orderId || this.generateOrderId('payment')
```

### **3. TokenGenerator (`src/utils/tokenGenerator.ts`):**
```typescript
// –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ generateOrderId:
static generateOrderId(prefix: string = 'order'): string {
  const timestamp = Date.now();
  const random = Math.floor(Math.random() * 1000);
  
  const cleanPrefix = prefix.replace(/[^a-zA-Z0-9_-]/g, '_');
  const orderId = `${cleanPrefix}_${timestamp}_${random}`;
  
  if (orderId.length > 64) {
    return orderId.substring(0, 64);
  }
  
  return orderId;
}
```

### **4. –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (`src/pages/TinkoffTest.tsx`):**
```typescript
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PaymentService.generateOrderId:
const orderId = PaymentService.generateOrderId('test');
```

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –∑–∞–∫–∞–∑–æ–≤:

### **–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- ‚ùå `payment_AI-______________360_1755049344954_37w2dh` (–æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–π)
- ‚ùå `payment_–ü—Ä–∏–º–µ—Ä__1234567890_abc123` (—Å–ª–æ–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)
- ‚ùå `test_service_1755049118732` (–Ω–µ—á–∏—Ç–∞–µ–º—ã–π)

### **–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- ‚úÖ `order_1755049344954_123` (–ø—Ä–æ—Å—Ç–æ–π –∏ —á–∏—Ç–∞–µ–º—ã–π)
- ‚úÖ `payment_1755049344954_456` (–ø–æ–Ω—è—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)
- ‚úÖ `test_1755049344954_789` (–∫—Ä–∞—Ç–∫–∏–π –∏ —è—Å–Ω—ã–π)

## üé® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞:

### **1. –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å:**
- **–ë—ã–ª–æ**: `payment_AI-______________360_1755049344954_37w2dh`
- **–°—Ç–∞–ª–æ**: `order_1755049344954_123`

### **2. –î–ª–∏–Ω–∞:**
- **–ë—ã–ª–æ**: 40+ —Å–∏–º–≤–æ–ª–æ–≤
- **–°—Ç–∞–ª–æ**: 20-25 —Å–∏–º–≤–æ–ª–æ–≤

### **3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- **–ë—ã–ª–æ**: `—Ç–∏–ø_–Ω–∞–∑–≤–∞–Ω–∏–µ_–≤—Ä–µ–º—è_—Å–ª—É—á–∞–π–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞`
- **–°—Ç–∞–ª–æ**: `–ø—Ä–µ—Ñ–∏–∫—Å_–≤—Ä–µ–º—è_—á–∏—Å–ª–æ`

### **4. –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ timestamp + random
- ‚úÖ –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –º–µ–∂–¥—É –∑–∞–∫–∞–∑–∞–º–∏
- ‚úÖ –õ–µ–≥–∫–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤ –ª–æ–≥–∞—Ö

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

### **1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:**
```bash
npm run dev
```

### **2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É:**
```
http://localhost:8080
```

### **3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É:**
```
http://localhost:8080/payment/test
```

### **4. –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ –ù–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–æ–≤ —Å—Ç–∞–ª–∏ –∫–æ—Ä–æ—á–µ –∏ —á–∏—Ç–∞–µ–º–µ–µ
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–∫–∏ `PaymentService.generateOrderId is not a function`
- ‚úÖ –ö–Ω–æ–ø–∫–∞ —Ä–∞—Å—Å—Ä–æ—á–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –í—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ

## üîç –û—Ç–ª–∞–¥–∫–∞:

### **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞:**
–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –ª–æ–≥–∏ —Å –ø—Ä–æ—Å—Ç—ã–º–∏ ID:
```
TinkoffPaymentCorrect: Generated order data: { orderId: "order_1755049344954_123", ... }
PaymentService: Starting payment initialization { orderId: "payment_1755049344954_456", ... }
```

### **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã:**
- –ó–∞–ø—Ä–æ—Å –∫ `https://securepay.tinkoff.ru/v2/Init`
- JSON —Å –ø—Ä–æ—Å—Ç—ã–º `OrderId: "order_1755049344954_123"`
- –°—Ç–∞—Ç—É—Å 200 OK

## üö® –†–µ—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

### **1. –û—à–∏–±–∫–∞ "PaymentService.generateOrderId is not a function":**
- ‚úÖ **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `generateOrderId` –≤ PaymentService
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ö–Ω–æ–ø–∫–∞ —Ä–∞—Å—Å—Ä–æ—á–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### **2. –°–ª–æ–∂–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–æ–≤:**
- ‚úÖ **–†–µ—à–µ–Ω–∏–µ**: –£–ø—Ä–æ—â–µ–Ω —Ñ–æ—Ä–º–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ID
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ß–∏—Ç–∞–µ–º—ã–µ –Ω–æ–º–µ—Ä–∞ —Ç–∏–ø–∞ `order_1755049344954_123`

### **3. –î–ª–∏–Ω–Ω—ã–µ ID –∑–∞–∫–∞–∑–æ–≤:**
- ‚úÖ **–†–µ—à–µ–Ω–∏–µ**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –¥–ª–∏–Ω–∞ –¥–æ 64 —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ö–æ—Ä–æ—Ç–∫–∏–µ –∏ –ø–æ–Ω—è—Ç–Ω—ã–µ –Ω–æ–º–µ—Ä–∞

## üéØ –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:

1. **–ù–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–æ–≤ —Å—Ç–∞–ª–∏ –ø—Ä–æ—â–µ**: `order_–≤—Ä–µ–º—è_—á–∏—Å–ª–æ`
2. **–ú–µ—Ç–æ–¥ generateOrderId –¥–æ–±–∞–≤–ª–µ–Ω** –≤ PaymentService
3. **–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç** –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
4. **–î–ª–∏–Ω–∞ ID –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞** 64 —Å–∏–º–≤–æ–ª–∞–º–∏ —Å–æ–≥–ª–∞—Å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º Tinkoff

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç:

–¢–µ–ø–µ—Ä—å –ø–ª–∞—Ç–µ–∂–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ:
- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ –∏ —á–∏—Ç–∞–µ–º—ã–µ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ —Å generateOrderId
- ‚úÖ –ö–Ω–æ–ø–∫–∞ —Ä–∞—Å—Å—Ä–æ—á–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –í—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –£–¥–æ–±–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤ –ª–æ–≥–∞—Ö

---

**üéâ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –ù–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–æ–≤ —Å—Ç–∞–ª–∏ –ø—Ä–æ—â–µ, –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.**
